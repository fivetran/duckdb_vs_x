┌───────────────────────────┐                                                                                                                    
│          ORDER_BY         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          ORDERS:          │                                                                                                                    
│    supplier.s_name ASC    │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           s_name          │                                                                                                                    
│         s_address         │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│            SEMI           │                                                                                                                    
│       s_suppkey = #0      ├───────────────────────────────────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│       EC: 307200488       │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │         ps_suppkey        │                                                          
│ s_nationkey = n_nationkey ├──────────────┐              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│         EC: 102400        │              │              │                           │                                                          
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          supplier         ││           nation          ││             #1            │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #2            │                                                          
│         s_suppkey         ││        n_nationkey        ││             #3            │                                                          
│        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
│           s_name          ││ Filters: n_name=CANADA AND││                           │                                                          
│         s_address         ││     n_name IS NOT NULL    ││                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
│        EC: 2560000        ││           EC: 1           ││                           │                                                          
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │           FILTER          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │    (CAST(ps_availqty AS   │                                                          
                                                          │ DECIMAL(38,3)) > SUBQUERY)│                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │       EC: 307200488       │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           SINGLE          │                                                          
                                                          │ ps_partkey IS NOT DISTINCT│                                                          
                                                          │       FROM ps_partkey     ├───────────────────────────────────────────┐              
                                                          │ ps_suppkey IS NOT DISTINCT│                                           │              
                                                          │       FROM ps_suppkey     │                                           │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
                                                          │       EC: 307200488       │                                           │              
                                                          └─────────────┬─────────────┘                                           │                                           
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                                                          │         HASH_JOIN         │                             │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │            SEMI           │                             │  (0.5 * sum(l_quantity))  │
                                                          │      ps_partkey = #0      ├──────────────┐              │         ps_partkey        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │         ps_suppkey        │
                                                          │       EC: 204800000       │              │              │                           │
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         PROJECTION        ││       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││         p_partkey         ││             #0            │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││             #1            │
                                                          │         ps_partkey        ││                           ││    sum_no_overflow(#2)    │
                                                          │        ps_availqty        ││                           ││                           │
                                                          │         ps_suppkey        ││                           ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │
                                                          │       EC: 204800000       ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │           FILTER          ││         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │  prefix(p_name, 'forest') ││         ps_partkey        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         ps_suppkey        │
                                                                                       │        EC: 10240000       ││         l_quantity        │
                                                                                       └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │            part           ││          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │           p_name          ││         l_partkey         │
                                                                                       │         p_partkey         ││         l_suppkey         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        │
                                                                                       │Filters: p_name>=forest AND││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │  p_name<foresu AND p_name ││ Filters: l_shipdate>=1994 │
                                                                                       │         IS NOT NULL       ││-01-01 AND l_shipdate<...  │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ -01 AND l_shipdate IS NOT │
                                                                                       │        EC: 10240000       ││            NULL           │
                                                                                       │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │                           ││       EC: 307200488       │
                                                                                       └───────────────────────────┘└───────────────────────────┘                             
