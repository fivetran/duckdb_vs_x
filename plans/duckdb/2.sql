┌───────────────────────┐                                                                                                                                                                                                        
│         TOP_N         │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        Top 100        │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│supplier.s_acctbal DESC│                                                                                                                                                                                                        
│   nation.n_name ASC   │                                                                                                                                                                                                        
│  supplier.s_name ASC  │                                                                                                                                                                                                        
│   part.p_partkey ASC  │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│       s_acctbal       │                                                                                                                                                                                                        
│         s_name        │                                                                                                                                                                                                        
│         n_name        │                                                                                                                                                                                                        
│       p_partkey       │                                                                                                                                                                                                        
│         p_mfgr        │                                                                                                                                                                                                        
│       s_address       │                                                                                                                                                                                                        
│        s_phone        │                                                                                                                                                                                                        
│       s_comment       │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│           #0          │                                                                                                                                                                                                        
│           #2          │                                                                                                                                                                                                        
│           #4          │                                                                                                                                                                                                        
│           #6          │                                                                                                                                                                                                        
│           #7          │                                                                                                                                                                                                        
│           #8          │                                                                                                                                                                                                        
│           #9          │                                                                                                                                                                                                        
│          #10          │                                                                                                                                                                                                        
│          #11          │                                                                                                                                                                                                        
│          #12          │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│         FILTER        │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│    (ps_supplycost =   │                                                                                                                                                                                                        
│        SUBQUERY)      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│      EC: 42326637     │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       HASH_JOIN       │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│         SINGLE        │                                                                                                                                                                                                        
│    p_partkey IS NOT   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                       
│ DISTINCT FROM p_p...  │                                                                                                                │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                │                                                                                       
│      EC: 42326637     │                                                                                                                │                                                                                       
└───────────┬───────────┘                                                                                                                │                                                                                                                
┌───────────┴───────────┐                                                                                                    ┌───────────┴───────────┐                                                                           
│       HASH_JOIN       │                                                                                                    │       PROJECTION      │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                           
│         INNER         │                                                                                                    │   min(ps_supplycost)  │                                                                           
│ ps_suppkey = s_suppkey├─────────────────────────────────────┐                                                              │       p_partkey       │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                     │                                                              │                       │                                                                           
│       EC: 171045      │                                     │                                                              │                       │                                                                           
└───────────┬───────────┘                                     │                                                              └───────────┬───────────┘                                                                                                    
┌───────────┴───────────┐                         ┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                                           
│       HASH_JOIN       │                         │       HASH_JOIN       │                                                  │     HASH_GROUP_BY     │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                           
│         INNER         │                         │         INNER         │                                                  │           #0          │                                                                           
│ ps_partkey = p_partkey├────────────┐            │     s_nationkey =     ├────────────┐                                     │        min(#1)        │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │            │            │       n_nationkey     │            │                                     │                       │                                                                           
│       EC: 827613      │            │            │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │            │                                     │                       │                                                                           
│                       │            │            │       EC: 512000      │            │                                     │                       │                                                                           
└───────────┬───────────┘            │            └───────────┬───────────┘            │                                     └───────────┬───────────┘                                                                                                    
┌───────────┴───────────┐┌───────────┴───────────┐┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐                                                                           
│       SEQ_SCAN        ││         FILTER        ││       SEQ_SCAN        ││       HASH_JOIN       │                         │       PROJECTION      │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                           
│        partsupp       ││suffix(p_type, 'BRASS')││        supplier       ││         INNER         │                         │       p_partkey       │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     n_regionkey =     │                         │     ps_supplycost     │                                                                           
│       ps_partkey      ││       EC: 204800      ││       s_suppkey       ││       r_regionkey     │                         │                       │                                                                           
│       ps_suppkey      ││                       ││      s_nationkey      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │                       │                                                                           
│     ps_supplycost     ││                       ││       s_acctbal       ││         EC: 5         ├────────────┐            │                       │                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                       ││         s_name        ││                       │            │            │                       │                                                                           
│     EC: 204800000     ││                       ││       s_address       ││                       │            │            │                       │                                                                           
│                       ││                       ││        s_phone        ││                       │            │            │                       │                                                                           
│                       ││                       ││       s_comment       ││                       │            │            │                       │                                                                           
│                       ││                       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                       │            │            │                       │                                                                           
│                       ││                       ││      EC: 2560000      ││                       │            │            │                       │                                                                           
└───────────────────────┘└───────────┬───────────┘└───────────────────────┘└───────────┬───────────┘            │            └───────────┬───────────┘                                                                                                    
                         ┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐┌───────────┴───────────┐                                                                           
                         │       SEQ_SCAN        │                         │       SEQ_SCAN        ││       SEQ_SCAN        ││       PROJECTION      │                                                                           
                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                           
                         │          part         │                         │         nation        ││         region        ││           #0          │                                                                           
                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││           #2          │                                                                           
                         │       p_partkey       │                         │      n_nationkey      ││      r_regionkey      ││                       │                                                                           
                         │         p_type        │                         │      n_regionkey      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                       │                                                                           
                         │         p_mfgr        │                         │         n_name        ││ Filters: r_name=EUROPE││                       │                                                                           
                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ AND r_name IS NOT NULL││                       │                                                                           
                         │ Filters: p_size=15 AND│                         │         EC: 25        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                       │                                                                           
                         │   p_size IS NOT NULL  │                         │                       ││         EC: 1         ││                       │                                                                           
                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │                       ││                       ││                       │                                                                           
                         │       EC: 204800      │                         │                       ││                       ││                       │                                                                           
                         └───────────────────────┘                         └───────────────────────┘└───────────────────────┘└───────────┬───────────┘                                                                                                    
                                                                                                                             ┌───────────┴───────────┐                                                                           
                                                                                                                             │       HASH_JOIN       │                                                                           
                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                           
                                                                                                                             │         INNER         │                                                                           
                                                                                                                             │ ps_suppkey = s_suppkey├────────────┐                                                              
                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │            │                                                              
                                                                                                                             │      EC: 42326637     │            │                                                              
                                                                                                                             └───────────┬───────────┘            │                                                                                       
                                                                                                                             ┌───────────┴───────────┐┌───────────┴───────────┐                                                  
                                                                                                                             │       SEQ_SCAN        ││       HASH_JOIN       │                                                  
                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
                                                                                                                             │        partsupp       ││         INNER         │                                                  
                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     s_nationkey =     │                                                  
                                                                                                                             │       ps_partkey      ││       n_nationkey     ├────────────┐                                     
                                                                                                                             │       ps_suppkey      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │            │                                     
                                                                                                                             │     ps_supplycost     ││       EC: 512000      │            │                                     
                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                       │            │                                     
                                                                                                                             │     EC: 204800000     ││                       │            │                                     
                                                                                                                             └───────────────────────┘└───────────┬───────────┘            │                                                              
                                                                                                                                                      ┌───────────┴───────────┐┌───────────┴───────────┐                         
                                                                                                                                                      │       SEQ_SCAN        ││       HASH_JOIN       │                         
                                                                                                                                                      │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         
                                                                                                                                                      │        supplier       ││         INNER         │                         
                                                                                                                                                      │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     n_regionkey =     │                         
                                                                                                                                                      │       s_suppkey       ││       r_regionkey     ├────────────┐            
                                                                                                                                                      │      s_nationkey      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │            │            
                                                                                                                                                      │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 5         │            │            
                                                                                                                                                      │      EC: 2560000      ││                       │            │            
                                                                                                                                                      └───────────────────────┘└───────────┬───────────┘            │                                     
                                                                                                                                                                               ┌───────────┴───────────┐┌───────────┴───────────┐
                                                                                                                                                                               │       SEQ_SCAN        ││       SEQ_SCAN        │
                                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                                                                               │         nation        ││         region        │
                                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                                                                               │      n_nationkey      ││      r_regionkey      │
                                                                                                                                                                               │      n_regionkey      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name=EUROPE│
                                                                                                                                                                               │         EC: 25        ││ AND r_name IS NOT NULL│
                                                                                                                                                                               │                       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                                                                               │                       ││         EC: 1         │
                                                                                                                                                                               └───────────────────────┘└───────────────────────┘                         
